<div class="match-page-wrapper">
    <div class="cinematic-bg" style="background-image: url('<%= event.thumbnail %>')"></div>

    <section class="container match-main">
        <div class="match-hero">
            <div class="match-meta-top">
                <span class="sport-label">
                    <%= event.sport.toUpperCase() %>
                </span>
                <span class="league-label">
                    <%= event.league %>
                </span>
                <% if (event.status==='live' ) { %>
                    <span class="live-indicator" data-live="true">üî¥ LIVE NOW</span>
                    <% } %>
            </div>

            <h1 class="match-title">
                <%= title %>
            </h1>

            <div class="match-time-info">
                <span class="time-badge">
                    ‚è±Ô∏è <%= new Date(event.startTime).toLocaleString([], { weekday: 'short' , month: 'short' ,
                        day: 'numeric' , hour: '2-digit' , minute: '2-digit' }) %>
                </span>
            </div>
        </div>

        <!-- 6Ô∏è‚É£ MATCH PAGE ‚Äî IFRAME GATING -->
        <div class="player-section">
            <div class="player-aspect-ratio">
                <div class="player-container" id="player-gate">
                    <% const now=Date.now(); const startTime=event.startTime; const diffMinutes=(startTime - now) /
                        (1000 * 60); const isLiveOrStartingSoon=event.status==='live' || diffMinutes <=30; %>

                        <% if (isLiveOrStartingSoon) { %>
                            <iframe src="<%= event.iframe %>" allowfullscreen scrolling="no"
                                allow="autoplay; encrypted-media"></iframe>
                            <% } else { %>
                                <div class="countdown-overlay">
                                    <div class="countdown-content">
                                        <h2>Match Starts Soon</h2>
                                        <div id="countdown-timer" data-start="<%= event.startTime %>">
                                            ‚è±Ô∏è Starts in --h --m
                                            01h 24m</div>
                                        <p>Stream will be available 30 minutes before kickoff.</p>
                                    </div>
                                </div>
                                <% } %>
                </div>
            </div>
            <div class="player-controls-hint">
                <span>Tip: If the stream freezes, try refreshing the page. Last updated: <%= new
                        Date(lastUpdated).toLocaleTimeString() %></span>
            </div>
        </div>

        <!-- 8Ô∏è‚É£ MATCH DETAIL ENRICHMENT -->
        <div class="match-details-grid">
            <div class="match-info-card">
                <h2>üèüÔ∏è Match Info</h2>
                <div class="info-row">
                    <span class="label">Teams:</span>
                    <span class="value">
                        <%= event.teams[0] %> vs <%= event.teams[1] %>
                    </span>
                </div>
                <div class="info-row">
                    <span class="label">Competition:</span>
                    <span class="value">
                        <%= event.league %>
                    </span>
                </div>
                <div class="info-row">
                    <span class="label">Kickoff:</span>
                    <span class="value">
                        <%= new Date(event.startTime).toLocaleString() %>
                    </span>
                </div>
                <div class="info-row">
                    <span class="label">Status:</span>
                    <span class="value status-<%= event.status %>">
                        <%= event.status==='live' ? 'üî¥ LIVE' : event.status.toUpperCase() %>
                    </span>
                </div>
            </div>

            <div class="match-seo-card">
                <h2>üì∞ Latest Team News</h2>
                <ul class="news-list">
                    <% teamNews.forEach(news=> { %>
                        <li>
                            <%= news %>
                        </li>
                        <% }) %>
                </ul>
            </div>
        </div>

        <div class="match-details-grid">
            <div class="match-info-card">
                <h2>üìä Head-to-Head (H2H)</h2>
                <div class="h2h-table">
                    <% h2h.forEach(item=> { %>
                        <div class="h2h-row">
                            <span class="h2h-date">
                                <%= item.date %>
                            </span>
                            <span class="h2h-match">
                                <%= item.match %>
                            </span>
                            <span class="h2h-result">
                                <%= item.result %>
                            </span>
                        </div>
                        <% }) %>
                </div>
            </div>

            <div class="match-seo-card">
                <h2>üìà Match Preview</h2>
                <p>
                    <%= matchPreview %>
                </p>
            </div>
        </div>

        <!-- ‚ùì FAQs (MANDATORY) -->
        <div class="seo-content-bottom">
            <h3>‚ùì Frequently Asked Questions</h3>
            <div class="faq-grid">
                <div class="faq-item">
                    <h4>What time does the match start?</h4>
                    <p>The match between <%= event.teams[0] %> and <%= event.teams[1] %> kicks off at <%= new
                                    Date(event.startTime).toLocaleTimeString() %> local time on <%= new
                                        Date(event.startTime).toLocaleDateString() %>.</p>
                </div>
                <div class="faq-item">
                    <h4>Is the match live?</h4>
                    <p>Yes, FootyBite provides real-time streaming links. The stream becomes active 30 minutes before
                        the scheduled kickoff.</p>
                </div>
                <div class="faq-item">
                    <h4>Where to watch <%= event.name %>?</h4>
                    <p>You can watch <%= event.name %> live right here on FootyBite. We aggregate the best
                            high-definition links for every major sporting event.</p>
                </div>
                <div class="faq-item">
                    <h4>Is it free?</h4>
                    <p>Yes, streaming on FootyBite is 100% free. No registration or credit card is required to access
                        our live sports links.</p>
                </div>
            </div>
        </div>

        <!-- Internal Link Overdrive -->
        <div class="related-matches-section">
            <h2 class="section-title">üîó Internal Link Overdrive</h2>
            <div class="internal-links-grid">
                <% if (teamLinks && teamLinks.length> 0) { %>
                    <div class="link-group">
                        <h4>More from these Teams</h4>
                        <ul>
                            <% teamLinks.forEach(link=> { %>
                                <li><a href="/<%= link.url %>">
                                        <%= link.name %>
                                    </a></li>
                                <% }) %>
                        </ul>
                    </div>
                    <% } %>
                        <% if (dateLinks && dateLinks.length> 0) { %>
                            <div class="link-group">
                                <h4>More Matches Today</h4>
                                <ul>
                                    <% dateLinks.forEach(link=> { %>
                                        <li><a href="/<%= link.url %>">
                                                <%= link.name %>
                                            </a></li>
                                        <% }) %>
                                </ul>
                            </div>
                            <% } %>
                                <div class="link-group">
                                    <h4>Popular Leagues</h4>
                                    <ul>
                                        <li><a href="/football/">Football Streams</a></li>
                                        <li><a href="/premier-league-live-stream-today/">Premier League Live</a></li>
                                        <li><a href="/nfl/">NFL Live Stream</a></li>
                                    </ul>
                                </div>
                                <div class="link-group">
                                    <h4>More on FootyBite</h4>
                                    <ul>
                                        <li><a href="/footybite-streams/">Footybite Streams</a></li>
                                        <li><a href="/live-footybite/">Live Footybite</a></li>
                                        <li><a href="/nba-footybite/">NBA Footybite</a></li>
                                        <li><a href="/nfl-footybite/">NFL Footybite</a></li>
                                        <li><a href="/footybite-reddit/">Footybite Reddit</a></li>
                                    </ul>
                                </div>
            </div>
        </div>

        <% if (related && related.length> 0) { %>
            <div class="related-matches-section">
                <h2 class="section-title">More Matches You Might Like</h2>
                <div class="match-grid">
                    <% related.forEach(rel=> { %>
                        <a href="/<%= rel.url %>" class="match-card-mini">
                            <div class="mini-thumb" style="background-image: url('<%= rel.thumbnail %>')"></div>
                            <div class="mini-info">
                                <span class="mini-league">
                                    <%= rel.league %>
                                </span>
                                <span class="mini-name">
                                    <%= rel.name %>
                                </span>
                            </div>
                        </a>
                        <% }) %>
                </div>
            </div>
            <% } %>
    </section>
</div>

<script>
    // 7Ô∏è‚É£ COUNTDOWN TIMER
    function updateCountdown() {
        const timerEl = document.getElementById('countdown-timer');
        if (!timerEl) return;

        const startTime = parseInt(timerEl.getAttribute('data-start'));
        const now = Date.now();
        const diff = startTime - now;

        if (diff <= 0) {
            timerEl.innerHTML = 'üî¥ LIVE NOW';
            if (diff > -1800000) {
                window.location.reload();
            }
            return;
        }

        const hours = Math.floor(diff / (1000 * 60 * 60));
        const minutes = Math.floor((diff % (1000 * 60 * 60)) / (1000 * 60));
        const seconds = Math.floor((diff % (1000 * 60)) / 1000);

        timerEl.innerHTML = `‚è±Ô∏è Starts in ${hours.toString().padStart(2, '0')}h ${minutes.toString().padStart(2, '0')}m ${seconds.toString().padStart(2, '0')}s`;

        if (diff <= 30 * 60 * 1000) {
            window.location.reload();
        }
    }

    setInterval(updateCountdown, 1000);
    updateCountdown();
</script>

<style>
    .countdown-overlay {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: #0f172a;
        display: flex;
        justify-content: center;
        align-items: center;
        text-align: center;
        padding: 20px;
    }

    .countdown-content h2 {
        font-size: 2rem;
        margin-bottom: 1rem;
        color: var(--primary);
    }

    #countdown-timer {
        font-size: 3rem;
        font-weight: 900;
        font-family: 'JetBrains Mono', monospace;
        margin-bottom: 1rem;
        color: var(--amber);
    }

    .countdown-content p {
        color: var(--gray);
    }

    .internal-links-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
        gap: 30px;
        background: var(--glass);
        padding: 30px;
        border-radius: 24px;
        border: 1px solid var(--glass-border);
    }

    .link-group h4 {
        color: var(--primary);
        margin-bottom: 15px;
        font-size: 1rem;
    }

    .link-group ul {
        list-style: none;
        padding: 0;
    }

    .link-group li {
        margin-bottom: 8px;
    }

    .link-group a {
        color: var(--gray);
        font-size: 0.9rem;
    }

    .link-group a:hover {
        color: var(--light);
        text-decoration: underline;
    }

    .news-list {
        list-style: none;
        padding: 0;
    }

    .news-list li {
        margin-bottom: 12px;
        color: var(--gray);
        font-size: 0.95rem;
        padding-left: 15px;
        position: relative;
    }

    .news-list li::before {
        content: '‚Ä¢';
        color: var(--primary);
        position: absolute;
        left: 0;
    }

    .h2h-table {
        display: flex;
        flex-direction: column;
        gap: 10px;
    }

    .h2h-row {
        display: flex;
        justify-content: space-between;
        padding: 8px 0;
        border-bottom: 1px solid var(--glass-border);
        font-size: 0.9rem;
    }

    .h2h-date {
        color: var(--gray);
    }

    .h2h-match {
        font-weight: 600;
    }

    .h2h-result {
        color: var(--amber);
        font-weight: 800;
    }
</style>